import pandas as pd
from sklearn import datasets, linear_model
import numpy as np
csv_data=pd.read_csv('name.csv')
list=csv_data.values.tolist()
#print(list)
x = np.array(list)
X = x[:, :-1]
Y = x[:, -1]
#print(X, Y)

# 训练数据
regr1 = linear_model.Lasso(normalize=True, alpha=0.000005,warm_start=True,fit_intercept=True,max_iter=100000)  # L1正则
regr1.fit(X, Y)
print('coefficients(b1,b2...):', regr1.coef_)
print('intercept(b0):', regr1.intercept_)

# 预测
x_test1 =[[0.15862108,0.916090875,0.583666386,0.905793326,0.561921473,0.059651433,0.83904082,0.125481253,0.096521414,0.779167444,0.452300425,0.299168503,0.860268837,0.336411785,0.293401574,0.635507821,0.722776441,0.240529647,0.367284622,0.702452955,0.954675254,0.725251981,0.784397796,0.64439784,0.718487513,0.801029415,0.970644755,0.513919059,0.482490919,0.42453806,0.629842628,0.23704463,0.527257046,0.239230124,
0.319581551,0.424218574,0.588961916,0.039747144,0.45263781,0.625982724,0.608599783,0.227873572,0.933866509,0.450466723,0.740103971,0.719967273,0.931739119,0.532008186,0.55460756,0.047069754,0.20464236,0.514933707,0.89396387,0.650232942,0.986920318,0.895908871,0.345651639,0.662948882,0.027698671,0.929601722,0.882571576,0.872659603,0.035789196,0.291676365,0.977502582,0.838859672,0.340716371,0.518539933,0.18120893,
0.146621107,0.612772857,0.686002316,0.647962805,0.222175668,0.794338713,0.874277013,0.857528266,0.929336603,0.466370153,0.741776433,0.520951891,0.358500777,0.689895199,0.370674804]]
y_test1 = regr1.predict(x_test1)
#print(x_test1)
print(y_test1)

print('score:', regr1.score(X, Y, sample_weight=None))

# 训练数据
regr2 = linear_model.LinearRegression()          # 多元线性回归
regr2.fit(X, Y)
print('coefficients(b1,b2...):', regr2.coef_)
print('intercept(b0):', regr2.intercept_)

# 预测

y_test2 = regr2.predict(x_test1)
#print(x_test1)
print(y_test2)

print('score:', regr2.score(X,Y,sample_weight=None))